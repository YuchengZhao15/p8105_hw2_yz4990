---
title: "p8105_hw2_yz4990"
author: "Yucheng Zhao"
date: "2024-10-01"
output: md_document
---


```{r}
library(tidyverse)
library(readxl)
```



## Problem 2

read and clean the dataset from "Mr. Trash Wheel", change sports_balls to integer
```{r}
mr_df = read_excel("./data/202409 Trash Wheel Collection Data.xlsx", 
                   sheet = "Mr. Trash Wheel", 
                   range = "A2:N653", 
                   na = c("", "NA")) |> 
  janitor::clean_names() |> 
  mutate(
    sports_balls = as.integer(round(sports_balls, 0))
  ) |> 
  mutate(
    trash_wheel_name = "mr",
    year = as.numeric(year),
    month = tolower(month)
  )
```

read and clean the datasets from "Professor Trash Wheel" and "Gwynnda Trash Wheel"
```{r}
prof_df = read_excel("./data/202409 Trash Wheel Collection Data.xlsx", 
                   sheet = "Professor Trash Wheel", 
                   range = "A2:M121", 
                   na = c("", "NA")) |> 
  janitor::clean_names() |> 
  mutate(
    trash_wheel_name = "professor",
    month = tolower(month)
  )

gw_df = read_excel("./data/202409 Trash Wheel Collection Data.xlsx", 
                   sheet = "Gwynnda Trash Wheel", 
                   range = "A2:L265", 
                   na = c("", "NA")) |> 
  janitor::clean_names() |> 
  mutate(
    trash_wheel_name = "gwynnda",
    month = tolower(month)
  )
```

combine the 3 datasets with the new variable "trash_wheel_name" 
```{r}
trash_wheel = 
  bind_rows(mr_df, prof_df, gw_df)

```

calculate the total weight and number of cigarette butts
```{r}
total_weight_prof = filter(trash_wheel, trash_wheel_name == "professor") |> 
  pull(weight_tons) |> 
  sum(na.rm = TRUE)

june22_cig_gw = filter(trash_wheel, trash_wheel_name == "gwynnda", year == 2022, month == "june") |> 
  pull(cigarette_butts) |> 
  sum(na.rm = TRUE)
```
The 3 dataset from "Mr. Trash Wheel," "Professor Trash Wheel," "Gwynnda Trash Wheel" each has `r nrow(mr_df)`, `r nrow(prof_df)`, and `r nrow(gw_df)` observations respectively. The combined dataset "trash_wheel" has `r nrow(trash_wheel)` observations. Its key variables include the date ("date"), weight of trash in tons ("weight_tons"), volume of trash in cubic yards ("volume_cubic_yards"), and the type of trash (including "plastic_bottles," "cigarette_butts," "glass_bottles," etc). The total weight of trash collected by Professor Trash Wheel is `r total_weight_prof` tons and the total number of cigarette butts collected by Gwynnda in June of 2022 is `r june22_cig_gw`. 


## Problem 3

read and clean the 3 datasets
```{r}
bakers_df = read_csv("./gbb_datasets/bakers.csv",
                     na = c("", "NA", "N/A") ) |> 
  janitor::clean_names() |> 
  rename(
    baker = baker_name
  )

bakes_df = read_csv("./gbb_datasets/bakes.csv",
                    na = c("", "NA", "N/A")) |> 
  janitor::clean_names()

results_df = read_csv("./gbb_datasets/results.csv",
                      na = c("", "NA", "N/A"), 
                      skip = 2) |> 
  janitor::clean_names()
```

using anti_join() to check for completeness and correctness
```{r}
anti_join(bakes_df, bakers_df, by = c("baker", "series"))
anti_join(results_df, bakers_df, by = c("baker", "series"))
anti_join(results_df, bakes_df, by = c("baker", "episode", "series"))
```

keep only the first name of bakers in bakers_df, combine and organize the datasets, export the final dataset
```{r}
bakers_df = mutate(bakers_df, 
                   baker = word(baker, 1))

gbbo_df = full_join(bakes_df, bakers_df, by = c("baker", "series")) |> 
  full_join(results_df, by = c("baker", "episode", "series")) |> 
  select(series, episode, baker, baker_age, baker_occupation, signature_bake, technical, hometown, show_stopper, result)

write_csv(gbbo_df, "./gbb_datasets/gbbo_df")
```
Describe your data cleaning process, including any questions you have or choices you made. Briefly discuss the final dataset.

I first cleaned each of the 3 datasets
```{r}

```



```{r}

```





